<?xml version="1.0"?>
<!DOCTYPE videomonkey [
    <!ELEMENT videomonkey    (default_device|devices)*>
    <!ELEMENT script    (#PCDATA)>
    <!ELEMENT param    EMPTY>
        <!ATTLIST param id CDATA "">
        <!ATTLIST param value CDATA "">
    <!ELEMENT default_device    (quality|performance|recipes|script|param|command)*>
    <!ELEMENT devices    (device_group*)>
    <!ELEMENT command    (#PCDATA)>
        <!ATTLIST command id CDATA "">
    <!ELEMENT quality    (quality_stop*)>
    <!ELEMENT quality_stop    (script|param|command)*>
        <!ATTLIST quality_stop title CDATA "">
        <!ATTLIST quality_stop bitrate CDATA "">
    <!ELEMENT performance    (performance_item*)>
    <!ELEMENT performance_item    (script|param|command)*>
        <!ATTLIST performance_item title CDATA "">
    <!ELEMENT recipes    (recipe*)>
    <!ELEMENT recipe    (#PCDATA)>
        <!ATTLIST recipe condition CDATA "">
    <!ELEMENT device_group    (device*)>
        <!ATTLIST device_group title CDATA "">
    <!ELEMENT device    (quality|performance|recipes|script|param|command|checkbox|menu)*>
        <!ATTLIST device title CDATA "">
        <!ATTLIST device icon CDATA "">
    <!ELEMENT checkbox    (checked_params|unchecked_params)*>
        <!ATTLIST checkbox which CDATA "">
        <!ATTLIST checkbox title CDATA "">
    <!ELEMENT checked_params    (script|param|command)*>
    <!ELEMENT unchecked_params    (script|param|command)*>
    <!ELEMENT menu    (menu_item*)>
        <!ATTLIST menu which CDATA "">
        <!ATTLIST menu title CDATA "">
    <!ELEMENT menu_item    (script|param|command)*>
        <!ATTLIST menu_item title CDATA "">
]>
<videomonkey>
    <default_device>
        <command id="ffmpeg_pass0"> -vpre $ffmpeg_vpre </command>
        <command id="ffmpeg_pass1"> -vpre $ffmpeg_vpre_pass1 -pass 1 -passlogfile $pass_log_file </command>
        <command id="ffmpeg_pass2"> -vpre $ffmpeg_vpre -pass 2 -passlogfile $pass_log_file </command>
        <command id="ffmpeg_options"> $ffmpeg_video_options $ffmpeg_audio_options </command>
		<command id="ffmpeg_video_options">
            -vcodec $ffmpeg_vcodec -b $bitrate -s $(output_video_width)x$(output_video_height) -aspect $(output_video_width):$(output_video_height) -r $(output_frame_rate):1000
		</command>
		<command id="ffmpeg_audio_options">
			-acodec $ffmpeg_acodec -ab $audio_bitrate -ar $audio_sample_rate -ac $audio_channels
		</command>
        <command id="quicktime_to_audio_file"> $qt_export $input_file --video=0 $tmp_audio_file </command>
        <command id="correct_yuv"> $yuvcorrect -v 0 -Y LUMINANCE_1.20_0_255_0_255 -Y CHROMINANCE_0_1.04_128_1.04_128_0_255 </command>
        <command id="quicktime_to_yuv"> $movtoy4m -f -w $input_video_width -h $input_video_height -F $framerate -a $aspect_ratio $input_file | $correct_yuv </command>
        <command id="yuv_to_ffmpeg_av"> $ffmpeg -y -i - -i $tmp_audio_file </command>
        <command id="yuv_to_ffmpeg_v"> $ffmpeg -y -i - </command>
        <command id="ffmpeg_normal"> $ffmpeg -y -i $input_file </command>
        <command id="quicktime_av_pass0"> $quicktime_to_yuv | $yuv_to_ffmpeg_av $ffmpeg_options $ffmpeg_pass0 $output_file </command>
        <command id="quicktime_av_pass1"> $quicktime_to_yuv | $yuv_to_ffmpeg_av $ffmpeg_options $ffmpeg_pass1 $output_file </command>
        <command id="quicktime_av_pass2"> $quicktime_to_yuv | $yuv_to_ffmpeg_av $ffmpeg_options $ffmpeg_pass2 $output_file </command>
        <command id="quicktime_v_pass0"> $quicktime_to_yuv | $yuv_to_ffmpeg_v $ffmpeg_options $ffmpeg_pass0 $output_file </command>
        <command id="quicktime_v_pass1"> $quicktime_to_yuv | $yuv_to_ffmpeg_v $ffmpeg_options $ffmpeg_pass1 $output_file </command>
        <command id="quicktime_v_pass2"> $quicktime_to_yuv | $yuv_to_ffmpeg_v $ffmpeg_options $ffmpeg_pass2 $output_file </command>
        <command id="normal_pass0"> $ffmpeg_normal $ffmpeg_options $ffmpeg_pass0 $output_file </command>
        <command id="normal_pass1"> $ffmpeg_normal $ffmpeg_options $ffmpeg_pass1 $output_file </command>
        <command id="normal_pass2"> $ffmpeg_normal $ffmpeg_options $ffmpeg_pass2 $output_file </command>
        <script>
            <![CDATA[
            
            function caseInsensitiveCompare(a,b) { return a.toLowerCase() == b.toLowerCase() }
            
            function audio(type)
            {
                switch(type) {
                    case "low":    params.audio_bitrate =  "16k"; params.audio_sample_rate = 11025; params.audio_channels = 1; break;
                    case "medium": params.audio_bitrate =  "32k"; params.audio_sample_rate = 22050; params.audio_channels = 1; break;
                    case "high":   params.audio_bitrate = "128k"; params.audio_sample_rate = 48000; params.audio_channels = 2; break;
                }
            }
            
            function all()
            {
                for (var i = 0; i < arguments.length; ++i)
                    if (!arguments[i])
                        return false;
                return true;
            }
            
            function any()
            {
                for (var i = 0; i < arguments.length; ++i)
                    if (arguments[i])
                        return true;
                return false;
            }
            
            function standardizeVideoCodecName(name)
            {
                if (caseInsensitiveCompare(name, "vc-1"))
                    return "wmv3";
                if (caseInsensitiveCompare(name, "avc") || caseInsensitiveCompare(name, "avc1"))
                    return "h.264";
                return name;
            }
            
            params.special_qt = params.is_quicktime == "true" && params.input_video_codec == "wmv3";
            
log("special_qt=",params.special_qt);
  			log("is_quicktime=", params.is_quicktime, ", input_video_codec=", params.input_video_codec, ", has_audio=", params.has_audio, ", is_2_pass=", params.is_2_pass);

           // adjust video frame size
            var inputAspect = params.input_video_width / params.input_video_height;
            var requestedAspect = params.frame_width / params.frame_height;
            if (inputAspect > requestedAspect) {
                // shorten height
                params.output_video_width = params.frame_width;
				params.output_video_height = params.frame_width / inputAspect;
			}
			else {
				// shorten width
				params.output_video_height = params.frame_height;
				params.output_video_width = params.frame_height * inputAspect;
			}
			
			// Make frame size divisible by 16
			params.output_video_width = Math.round(params.output_video_width / 16) * 16;
			params.output_video_height = Math.round(params.output_video_height / 16) * 16;
			
			// set frame rate
			params.output_frame_rate = params.input_frame_rate * params.frame_rate * 1000;
			
           
            ]]>
        </script>
        <quality>
            <quality_stop title="Tiny" bitrate="400000">
                <script> audio('low') </script> 
                <param id="size" value="640x480" />
                <param id="frame_rate" value="0.5" />
            </quality_stop>
            <quality_stop title="Low" bitrate="800000">
                <script> audio('high') </script> 
                <param id="size" value="640x480" />
                <param id="frame_rate" value="1" />
            </quality_stop>
            <quality_stop title="Standard" bitrate="1100000">
                <script> audio('high') </script> 
                <param id="size" value="640x480" />
                <param id="frame_rate" value="1" />
            </quality_stop>
            <quality_stop title="High" bitrate="1500000">
                <script> audio('high') </script> 
                <param id="size" value="640x480" />
                <param id="frame_rate" value="1" />
            </quality_stop>
            <quality_stop title="Go Nuts" bitrate="2000000">
                <script> audio('high') </script> 
                <param id="size" value="640x480" />
                <param id="frame_rate" value="1" />
            </quality_stop>
        </quality>
        <performance>
            <performance_item title="Fastest">
                <param id="is_2_pass" value="false" />
                <param id="ffmpeg_vpre" value="fastest" />
            </performance_item>
            <performance_item title="Fast">
                <param id="is_2_pass" value="false" />
                <param id="ffmpeg_vpre" value="default" />
            </performance_item>
            <performance_item title="Normal">
                <param id="is_2_pass" value="false" />
                <param id="ffmpeg_vpre" value="normal" />
            </performance_item>
            <performance_item title="Normal (2 pass)">
              	<param id="is_2_pass" value="true" />
               	<param id="ffmpeg_vpre" value="normal" />
               	<param id="ffmpeg_vpre_pass1" value="normal-pass1" />
             </performance_item>
            <performance_item title="High Quality">
                <param id="is_2_pass" value="false" />
                <param id="ffmpeg_vpre" value="hq" />
            </performance_item>
            <performance_item title="High Quality (2 pass)">
                <param id="is_2_pass" value="true" />
                <param id="ffmpeg_vpre" value="hq" />
              	<param id="ffmpeg_vpre_pass1" value="hq-pass1" />
				<script> log("ffmpeg_vpre_pass1=", params.ffmpeg_vpre_pass1) </script>
            </performance_item>
        </performance>
        <param id="ffmpeg_vcodec" value="libx264" />
        <param id="ffmpeg_acodec" value="libfaac" />
        <param id="video_suffix" value="mp4" />
        <recipes>
            <recipe condition="all(params.special_qt=='false', params.has_audio=='false', params.is_2_pass=='false')">
                $normal_pass0
            </recipe>
            <recipe condition="all(params.special_qt=='false', params.has_audio=='false', params.is_2_pass=='true')">
                $normal_pass1 ; $normal_pass2
            </recipe>
            <recipe condition="all(params.special_qt=='false', params.has_audio=='true', params.is_2_pass=='false')">
                $normal_pass0
            </recipe>
            <recipe condition="all(params.special_qt=='false', params.has_audio=='true', params.is_2_pass=='true')">
                $normal_pass1 ; $normal_pass2
            </recipe>
            <recipe condition="all(params.special_qt=='true', params.has_audio=='false', params.is_2_pass=='false')">
                $quicktime_v_pass0
            </recipe>
            <recipe condition="all(params.special_qt=='true', params.has_audio=='false', params.is_2_pass=='true')">
                $quicktime_v_pass1 ; $quicktime_v_pass2
            </recipe>
            <recipe condition="all(params.special_qt=='true', params.has_audio=='true', params.is_2_pass=='false')">
                $quicktime_to_audio_file ; $quicktime_av_pass0
            </recipe>
            <recipe condition="all(params.special_qt=='true', params.has_audio=='true', params.is_2_pass=='true')">
                $quicktime_to_audio_file ; $quicktime_av_pass1 ; $quicktime_av_pass2
            </recipe>
        </recipes>
    </default_device>
    <devices>
    
        <!--
        
            iTunes Group
            
        -->
        <device_group title="iTunes">
            <!-- All Apple Devices -->
            <device title="All Apple Devices" icon="itunesfile">
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
            </device>
            
            <!-- iPod 5G -->
            <device title="iPod5G" icon="ipod">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- iPod classic -->
            <device title="iPod classic" icon="ipod">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- iPod nano -->
            <device title="iPod nano" icon="nano">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>

            <!-- iPhone -->
            <device title="iPhone" icon="iphone">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="frame_width" value="192" />
                        <param id="frame_height" value="144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="frame_width" value="480" />
                        <param id="frame_height" value="320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="frame_width" value="480" />
                        <param id="frame_height" value="320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="frame_width" value="640" />
                        <param id="frame_height" value="480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="frame_width" value="640" />
                        <param id="frame_height" value="480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- iPod touch -->
            <device title="iPod touch" icon="iphone">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- Apple TV -->
            <device title="Apple TV" icon="appletv">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
        </device_group>


        <!--
        
            Video Devices Group
            
        -->
        <device_group title="Video Devices">
            <!-- DV -->
            <device title="DV" icon="dv">
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
            </device>
            
            <!-- DVD -->
            <device title="DVD" icon="cd">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- Tivo Series 2 -->
            <device title="Tivo Series 2" icon="tivo">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- Tivo Series 3 -->
            <device title="Tivo Series 3" icon="tivo">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>

            <!-- 3g Cell Phones -->
            <device title="3g Cell Phones" icon="3g">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
        </device_group>


        <!--
        
            Game Systems Group
            
        -->
        <device_group title="Game Systems">
            <!-- XBox 360 -->
            <device title="XBox 360" icon="xbox360">
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
            </device>
            
            <!-- PSP -->
            <device title="PSP" icon="psp">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- Playstation 3 -->
            <device title="Playstation 3" icon="ps3">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- Nintendo Wii -->
            <device title="Nintendo Wii" icon="wii">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
        </device_group>


        <!--
        
            Generic Formats Group
            
        -->
        <device_group title="Generic Formats">
            <!-- AVI -->
            <device title="AVI" icon="file">
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
            </device>
            
            <!-- MP4 -->
            <device title="MP4" icon="file">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- QuickTime -->
            <device title="QuickTime" icon="file">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- WMV -->
            <device title="WMV" icon="wma">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>

            <!-- Flash -->
            <device title="Flash" icon="flash">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
            
            <!-- MPEG -->
            <device title="MPEG" icon="file">
                <quality>
                    <quality_stop title="EDGE" bitrate="50000">
                        <script> audio('low') </script> 
                        <param id="size" value="192x144" />
                        <param id="frame_rate" value="0.5" />
                    </quality_stop>
                    <quality_stop title="3G" bitrate="100000">
                        <script> audio('medium') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="WiFi" bitrate="1100000">
                        <script> audio('high') </script> 
                        <param id="size" value="480x320" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="High" bitrate="1800000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                    <quality_stop title="Go Nuts" bitrate="3000000">
                        <script> audio('high') </script> 
                        <param id="size" value="640x480" />
                        <param id="frame_rate" value="1" />
                    </quality_stop>
                </quality>
                <checkbox which="0" title="H.264 Video (slower but better)">
                    <checked_params>
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </checked_params>
                    <unchecked_params>
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </unchecked_params>
                </checkbox>
                <menu which="0" title="Best for:">
                    <menu_item title="iPhone Screen">
                        <param id="ffmpeg_vcodec" value="libx264" />
                    </menu_item>
                    <menu_item title="TV Screen">
                        <param id="ffmpeg_vcodec" value="mpeg4" />
                    </menu_item>
                </menu>
            </device>
        </device_group>
    </devices>
</videomonkey>

        